const { Client } = require('pg');
(async () => {
  const conn = process.env.DATABASE_URL || 'postgresql://postgres:Maina@123@localhost:5432/saasdb';
  const c = new Client({ connectionString: conn });
  try {
    await c.connect();
    const res = await c.query("SELECT id, sha256, positives, (vt_response->>'mocked')::text AS mocked, vt_last_seen, scanned_at FROM malware_results ORDER BY scanned_at DESC LIMIT 20");
    console.log('malware_results rows:', res.rows);
  } catch (e) {
    console.error('ERROR show_malware_results:', e.message || e);
    process.exitCode = 1;
  } finally {
    await c.end();
  }
})();
